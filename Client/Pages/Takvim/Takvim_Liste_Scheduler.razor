@page "/takvim_listef_scheduler"
@inject Radzen.DialogService DialogService

    <HeaderSearchBar header="header"
                     ShowButtons="true" ShowFilterButton="false"
                     ShowSearchSection="false"></HeaderSearchBar>


    <RadzenScheduler @ref=@scheduler SlotRender=@OnSlotRender style="height: 500px;" TItem="TakvimDto" Data=@appointments StartProperty="Tarih" EndProperty="Tarih"
                     TextProperty="Baslik" SelectedIndex="2"
                     AppointmentRender=@OnAppointmentRender>
        <RadzenDayView />
        <RadzenWeekView />
        <RadzenMonthView />
    </RadzenScheduler>

    @code {



        public HeaderBarSearch header = new HeaderBarSearch();

        RadzenScheduler<TakvimDto> scheduler;
        Dictionary<DateTime, string> events = new Dictionary<DateTime, string>();

        IList<TakvimDto> appointments = new List<TakvimDto>
    {
        new TakvimDto { Tarih = DateTime.Today.AddDays(-2) , Baslik = "Birthday" },
        new TakvimDto { Tarih = DateTime.Today.AddDays(-11), Baslik = "Day off" },
        new TakvimDto { Tarih = DateTime.Today.AddDays(-10),  Baslik = "Work from home" },
        new TakvimDto { Tarih = DateTime.Today.AddHours(10),  Baslik = "Online meeting" },
        new TakvimDto { Tarih = DateTime.Today.AddHours(10),  Baslik = "Skype call" },
        new TakvimDto { Tarih = DateTime.Today.AddHours(14),  Baslik = "Dentist appointment" },
        new TakvimDto { Tarih = DateTime.Today.AddDays(1) , Baslik = "Vacation" },
    };

        void OnSlotRender(SchedulerSlotRenderEventArgs args)
        {
            // Highlight today in month view
            if (args.View.Text == "Month" && args.Start.Date == DateTime.Today)
            {
                args.Attributes["style"] = "background: rgba(255,220,40,.2);";
            }

            // Highlight working hours (9-18)
            if ((args.View.Text == "Week" || args.View.Text == "Day") && args.Start.Hour > 8 && args.Start.Hour < 19)
            {
                args.Attributes["style"] = "background: rgba(255,220,40,.2);";
            }
        }

 

        void OnAppointmentRender(SchedulerAppointmentRenderEventArgs<TakvimDto> args)
        {
            // Never call StateHasChanged in AppointmentRender - would lead to infinite loop

            if (args.Data.Baslik == "Birthday")
            {
                args.Attributes["style"] = "background: red";
            }
        }
    }
